---
title: "Rarepair Rumble"
author: "darthaline"
date: "3 Aug 2020"
output:
  html_notebook:
    code_folding: "hide"
---

# About
This is a document detailing analysis of [TDP Rarepair Rumble 2020](https://tdp-shipping-dock.tumblr.com/rarepair-rumble) starting from Round 2CD. Event is hosted by Inga, who kindly gave me access to the resposes data.

```{r setup, collapse=TRUE}
# code chunks are collapsed:
# https://stackoverflow.com/a/52589123/4819684

#setting working directory
knitr::opts_knit$set(root.dir = '.')

#loading packages
library("lubridate") # for handling dates
library('ggplot2') # for plotting
library('cowplot') # for plotting
library("RColorBrewer") # for choosing colors

```

## Round 2CD

In this round I didn't have direct information where did which individual response come from, so the source is based on estimation of when was the pool posted on each individual platform, as determined by the creation dates of the screenshots Inga provided.

```{r round2cdData, collapse=TRUE}
data <- read.csv2 (file.path('data','Rarepair Rumble Round 2CD (Responses) - Form responses 1.csv'), header = TRUE, sep=',')
data <- sapply(data, as.character)
data[data == ''] <- "_don't want to vote"
data[data == "I don't want to vote for either of these ships"] <- "_don't want to vote"
data <- data.frame(data)

data$source <- 'discord'
data[13:35,]$source <- 'tumblr&ao3'
data[36:51,]$source <- 'twitter&reddit'
data[52:69,]$source <- 'instagram'

data$Timestamp <- parse_date_time2(as.character(data$Timestamp), orders = "%d/%m/%Y %H:%M:%S")
data$day <- as.Date(data$Timestamp)

custompalette <- brewer.pal(n=4, name = 'Dark2')
#display.brewer.pal(name = 'Dark2', n=4)

```

```{r round2cdPlots, collapse=TRUE, fig.width=12, fig.height=20}

plot_data_column <- function (data, column, legendPosition) {
    ggplot(data, aes_string(x = column)) + 
    geom_bar(aes(col=source, fill=source), alpha = 0.5)+
    scale_colour_manual(values = custompalette)+
    scale_fill_manual(values = custompalette) +
    theme_half_open() +
    background_grid() +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
          axis.title.y=element_blank(),
          axis.title.x=element_blank(),
          legend.position = legendPosition)
}

myplots <- lapply(colnames(data)[2:17], plot_data_column, data = data, legendPosition = 'none')
mylegend <- get_legend(plot_data_column(data, colnames(data)[2], 'right') + 
                       theme(legend.title=element_blank()))

plot_grid(plot_grid(plotlist = myplots, align='hv'),
          plot_grid(plotlist = rep(list(mylegend),4), nrow=4, rel_heights = c(1,3,2,3)),
          rel_widths = c(4,1),
          align='hv')

```